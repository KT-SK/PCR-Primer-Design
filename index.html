<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="utf-8" /&gt;</p>
<p class="p1">&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1">&lt;title&gt;DNA Primer Design Tool — Single File&lt;/title&gt;</p>
<p class="p1">&lt;meta name="description" content="Offline DNA Primer Design Tool — generate PCR primer pairs with Tm, GC, hairpin, dimer, GC clamp checks, copy/save/export, and more." /&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1">/* =========================</p>
<p class="p1"><span class="Apple-converted-space">   </span>THEME &amp; LAYOUT VARIABLES</p>
<p class="p1"><span class="Apple-converted-space">   </span>========================= */</p>
<p class="p1">:root{</p>
<p class="p1"><span class="Apple-converted-space">  </span>--bg-primary: rgb(240,248,255); /* very light sky blue */</p>
<p class="p1"><span class="Apple-converted-space">  </span>--surface: rgb(255,255,255); /* bright white */</p>
<p class="p1"><span class="Apple-converted-space">  </span>--mint: rgb(144,238,144);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--mint-weak: rgba(144,238,144,0.08);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--cyan: rgb(0,255,255);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--cyan-weak: rgba(0,255,255,0.06);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--lav: rgb(230,230,250);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--lav-weak: rgba(230,230,250,0.06);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--peach: rgb(255,239,213);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--peach-weak: rgba(255,239,213,0.06);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--sunny: rgb(255,255,153);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--text-primary: rgba(45,55,75,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--text-secondary: rgba(100,115,130,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--status-green: rgba(50,205,50,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--status-yellow: rgba(255,215,0,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--status-red: rgba(255,127,80,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--border: rgba(220,230,240,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--shadow: 0 4px 12px rgba(0,0,0,0.08);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--radius-card: 18px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>--card-padding: 24px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>--accent-glow: rgba(0,255,255,0.14);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--max-width: 1200px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>--ease: cubic-bezier(.2,.9,.2,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>--anim-fast: 300ms;</p>
<p class="p1"><span class="Apple-converted-space">  </span>--anim-med: 400ms;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Reset &amp; base ====== */</p>
<p class="p1">*{box-sizing:border-box}</p>
<p class="p1">html,body{height:100%}</p>
<p class="p1">body{</p>
<p class="p1"><span class="Apple-converted-space">  </span>margin:0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-family: Inter, "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial;</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: linear-gradient(180deg, var(--bg-primary) 0%, #f8fdff 100%);</p>
<p class="p1"><span class="Apple-converted-space">  </span>color:var(--text-primary);</p>
<p class="p1"><span class="Apple-converted-space">  </span>-webkit-font-smoothing:antialiased;</p>
<p class="p1"><span class="Apple-converted-space">  </span>-moz-osx-font-smoothing:grayscale;</p>
<p class="p1"><span class="Apple-converted-space">  </span>line-height:1.6;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:32px 20px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>justify-content:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:flex-start;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* Reduce motion */</p>
<p class="p1">@media (prefers-reduced-motion: reduce) {</p>
<p class="p1"><span class="Apple-converted-space">  </span>* { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Container ====== */</p>
<p class="p1">.container{</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:100%;</p>
<p class="p1"><span class="Apple-converted-space">  </span>max-width:var(--max-width);</p>
<p class="p1"><span class="Apple-converted-space">  </span>margin:0 auto;</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>grid-template-columns: 1fr;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:24px;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Header ====== */</p>
<p class="p1">.header {</p>
<p class="p1"><span class="Apple-converted-space">  </span>background:var(--surface);</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius: var(--radius-card);</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding: var(--card-padding);</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: var(--shadow);</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:20px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>overflow:hidden;</p>
<p class="p1"><span class="Apple-converted-space">  </span>transform-origin:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>opacity:0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>animation: fadeIn 450ms var(--ease) forwards;</p>
<p class="p1">}</p>
<p class="p1">.title {</p>
<p class="p1"><span class="Apple-converted-space">  </span>flex:1;</p>
<p class="p1">}</p>
<p class="p1">.h1 {</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-size:42px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-weight:700;</p>
<p class="p1"><span class="Apple-converted-space">  </span>letter-spacing:0.5px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>margin:0 0 8px 0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>color:var(--text-primary);</p>
<p class="p1">}</p>
<p class="p1">.h2 {</p>
<p class="p1"><span class="Apple-converted-space">  </span>margin:0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-size:14px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>color:var(--text-secondary);</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-weight:400;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Grid layout for main content ====== */</p>
<p class="p1">.main-grid{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>grid-template-columns: 1fr 420px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:24px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:start;</p>
<p class="p1">}</p>
<p class="p1">@media (max-width: 1024px){</p>
<p class="p1"><span class="Apple-converted-space">  </span>.main-grid{ grid-template-columns: 1fr; }</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Cards ====== */</p>
<p class="p1">.card{</p>
<p class="p1"><span class="Apple-converted-space">  </span>background:var(--surface);</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius: var(--radius-card);</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding: var(--card-padding);</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: var(--shadow);</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>overflow:hidden;</p>
<p class="p1"><span class="Apple-converted-space">  </span>opacity:0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>transform: translateY(8px);</p>
<p class="p1"><span class="Apple-converted-space">  </span>animation: fadeUp 420ms var(--ease) forwards;</p>
<p class="p1">}</p>
<p class="p1">.card.delay-1{ animation-delay: 120ms; }</p>
<p class="p1">.card.delay-2{ animation-delay: 240ms; }</p>
<p class="p1">.card.delay-3{ animation-delay: 360ms; }</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Animations ====== */</p>
<p class="p1">@keyframes fadeIn { from { opacity:0; transform: translateY(6px) } to { opacity:1; transform:none } }</p>
<p class="p1">@keyframes fadeUp { from { opacity:0; transform: translateY(12px) } to { opacity:1; transform:none } }</p>
<p class="p1">@keyframes pulseOnce {</p>
<p class="p1"><span class="Apple-converted-space">  </span>0%{ transform:scale(1); opacity:1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>50%{ transform:scale(1.06); opacity:0.9 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>100%{ transform:scale(1); opacity:1 }</p>
<p class="p1">}</p>
<p class="p1">@keyframes badgePulse {</p>
<p class="p1"><span class="Apple-converted-space">  </span>0%{ transform:scale(1); opacity:1 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>50%{ transform:scale(1.06); opacity:0.85 }</p>
<p class="p1"><span class="Apple-converted-space">  </span>100%{ transform:scale(1); opacity:1 }</p>
<p class="p1">}</p>
<p class="p1">@keyframes slideInRight { from { transform: translateX(18px); opacity:0 } to { transform:none; opacity:1 } }</p>
<p class="p2"><br></p>
<p class="p1">.header .logo {</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:76px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>height:76px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: linear-gradient(135deg, var(--mint), var(--cyan));</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>justify-content:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>color: #09303a;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-weight:700;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-size:20px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: 0 6px 16px rgba(0,0,0,0.06);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Input section ====== */</p>
<p class="p1">.input-area{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>flex-direction:column;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1">}</p>
<p class="p1">.textarea {</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:100%;</p>
<p class="p1"><span class="Apple-converted-space">  </span>min-height:220px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>max-height:520px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:16px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:10px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: rgba(250,250,255,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>resize:vertical;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-family: "Courier New", monospace;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-size:14px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>color: var(--text-primary);</p>
<p class="p1"><span class="Apple-converted-space">  </span>outline:none;</p>
<p class="p1"><span class="Apple-converted-space">  </span>transition: all 250ms var(--ease);</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: none;</p>
<p class="p1">}</p>
<p class="p1">.textarea:focus{</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-color: var(--mint);</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: 0 6px 20px var(--accent-glow);</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: rgba(240,255,240,0.9);</p>
<p class="p1">}</p>
<p class="p1">.controls {</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>justify-content:space-between;</p>
<p class="p1"><span class="Apple-converted-space">  </span>flex-wrap:wrap;</p>
<p class="p1">}</p>
<p class="p1">.charcount {</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-size:13px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>color:var(--text-secondary);</p>
<p class="p1">}</p>
<p class="p1">.small-btn{</p>
<p class="p1"><span class="Apple-converted-space">  </span>background:linear-gradient(180deg, rgba(255,255,255,1), rgba(245,245,255,1));</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:10px 14px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:10px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>cursor:pointer;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-weight:600;</p>
<p class="p1"><span class="Apple-converted-space">  </span>transition: all var(--anim-fast) var(--ease);</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow:none;</p>
<p class="p1">}</p>
<p class="p1">.small-btn:hover{ transform:scale(1.03); box-shadow: 0 8px 20px rgba(0,0,0,0.06) }</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Parameter panel ====== */</p>
<p class="p1">.params {</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1">}</p>
<p class="p1">.param-group{</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:14px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,255,0.9));</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1">}</p>
<p class="p1">.param-grid{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>grid-template-columns: 1fr 1fr;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1">}</p>
<p class="p1">@media (max-width:768px){ .param-grid{ grid-template-columns: 1fr } }</p>
<p class="p1">.param-label{ font-weight:600; color: rgba(70,85,105,1); font-size:14px }</p>
<p class="p1">.param-input{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:8px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:center;</p>
<p class="p1">}</p>
<p class="p1">.number-input{</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:100%;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:10px 12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:8px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: rgba(250,250,255,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>outline:none;</p>
<p class="p1"><span class="Apple-converted-space">  </span>transition: all 200ms var(--ease);</p>
<p class="p1">}</p>
<p class="p1">.number-input:focus{ box-shadow: 0 6px 18px rgba(173,255,47,0.12); border-color: var(--mint) }</p>
<p class="p2"><br></p>
<p class="p1">/* slider styling */</p>
<p class="p1">.range-row{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:flex;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:8px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:center;</p>
<p class="p1">}</p>
<p class="p1">input[type="range"]{</p>
<p class="p1"><span class="Apple-converted-space">  </span>-webkit-appearance:none;</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:100%;</p>
<p class="p1"><span class="Apple-converted-space">  </span>height:10px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:6px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: linear-gradient(90deg, rgba(144,238,144,0.3), rgba(0,255,255,0.3));</p>
<p class="p1"><span class="Apple-converted-space">  </span>outline:none;</p>
<p class="p1">}</p>
<p class="p1">input[type="range"]::-webkit-slider-thumb{</p>
<p class="p1"><span class="Apple-converted-space">  </span>-webkit-appearance:none;</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:18px;height:18px;border-radius:50%;background:var(--cyan);box-shadow:0 2px 8px rgba(0,0,0,0.12)</p>
<p class="p1">}</p>
<p class="p1">.toggle{</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:48px;height:28px;border-radius:16px;background:rgba(230,230,230,0.7);position:relative;cursor:pointer;border:1px solid var(--border);</p>
<p class="p1">}</p>
<p class="p1">.toggle.on{ background: linear-gradient(90deg,var(--mint),var(--cyan)); }</p>
<p class="p1">.toggle .dot{ position:absolute; top:4px; left:4px;width:20px;height:20px;border-radius:50%;background:white; transition: all 250ms var(--ease) }</p>
<p class="p1">.toggle.on .dot{ left:24px }</p>
<p class="p2"><br></p>
<p class="p1">/* ===== CTA ===== */</p>
<p class="p1">.cta-row{ display:flex; gap:12px; align-items:center; justify-content:flex-start; flex-wrap:wrap }</p>
<p class="p1">.primary-cta{</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: linear-gradient(180deg, var(--cyan), #bfffff);</p>
<p class="p1"><span class="Apple-converted-space">  </span>color: #003a3a;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:16px 36px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:10px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-weight:600;</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-size:16px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">  </span>cursor:pointer;</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: 0 8px 28px rgba(0,255,255,0.08);</p>
<p class="p1"><span class="Apple-converted-space">  </span>transition: all var(--anim-fast) var(--ease);</p>
<p class="p1"><span class="Apple-converted-space">  </span>transform-origin:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>animation: pulseOnce 2s var(--ease) infinite;</p>
<p class="p1">}</p>
<p class="p1">.primary-cta:hover{ transform:scale(1.05); box-shadow: 0 12px 32px rgba(0,0,0,0.08) }</p>
<p class="p1">.primary-cta:active{ transform:scale(0.99) }</p>
<p class="p2"><br></p>
<p class="p1">/* stop pulsing on focus or after first click */</p>
<p class="p1">.primary-cta.clicked{ animation:none; }</p>
<p class="p2"><br></p>
<p class="p1">/* ===== Loading overlay ===== */</p>
<p class="p1">.loading {</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:none;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>justify-content:center;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:18px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:10px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: linear-gradient(90deg, rgba(255,255,255,0.9), rgba(240,255,255,0.95));</p>
<p class="p1"><span class="Apple-converted-space">  </span>border: 1px solid var(--border);</p>
<p class="p1">}</p>
<p class="p1">.spinner{</p>
<p class="p1"><span class="Apple-converted-space">  </span>width:36px;height:36px;border-radius:50%;border:4px solid rgba(0,0,0,0.06);border-top:4px solid var(--cyan);</p>
<p class="p1"><span class="Apple-converted-space">  </span>animation: spin 900ms linear infinite;</p>
<p class="p1">}</p>
<p class="p1">@keyframes spin{ from{ transform:rotate(0deg) } to{ transform:rotate(360deg) } }</p>
<p class="p2"><br></p>
<p class="p1">/* ===== Results layout ===== */</p>
<p class="p1">.results-grid{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1">}</p>
<p class="p1">.results-list{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>grid-template-columns: repeat(2, 1fr);</p>
<p class="p1">}</p>
<p class="p1">@media (max-width:900px){ .results-list{ grid-template-columns: 1fr } }</p>
<p class="p1">.pair-card{</p>
<p class="p1"><span class="Apple-converted-space">  </span>border-radius:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:16px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">  </span>background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,255,0.98));</p>
<p class="p1"><span class="Apple-converted-space">  </span>box-shadow: var(--shadow);</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">  </span>gap:12px;</p>
<p class="p1"><span class="Apple-converted-space">  </span>transform: translateY(12px);</p>
<p class="p1"><span class="Apple-converted-space">  </span>opacity:0;</p>
<p class="p1">}</p>
<p class="p1">.pair-card.show{ animation: cardIn 420ms var(--ease) forwards; }</p>
<p class="p1">@keyframes cardIn { to { transform:none; opacity:1 } }</p>
<p class="p2"><br></p>
<p class="p1">.primer-row{ display:flex; gap:12px; align-items:flex-start; }</p>
<p class="p1">.primer-box{ flex:1; padding:12px; border-radius:10px; border:1px solid var(--border) }</p>
<p class="p1">.primer-box.fwd{ background: rgba(240,255,240,1) }</p>
<p class="p1">.primer-box.rev{ background: rgba(240,255,255,1) }</p>
<p class="p1">.seq {</p>
<p class="p1"><span class="Apple-converted-space">  </span>font-family: "Courier New", monospace;</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: rgba(245,245,255,1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:8px;border-radius:8px;display:block;overflow:auto;font-size:13px;</p>
<p class="p1">}</p>
<p class="p1">.meta-grid{ display:grid; grid-template-columns: repeat(2,1fr); gap:8px; margin-top:8px; }</p>
<p class="p1">@media (max-width:600px){ .meta-grid{ grid-template-columns: 1fr } }</p>
<p class="p1">.badge{</p>
<p class="p1"><span class="Apple-converted-space">  </span>display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px; font-weight:700; font-size:13px;</p>
<p class="p1">}</p>
<p class="p1">.badge.pass{ background: var(--status-green); color: #043204; }</p>
<p class="p1">.badge.warn{ background: var(--status-yellow); color: #4a3300; }</p>
<p class="p1">.badge.fail{ background: var(--status-red); color: #5a1f00; }</p>
<p class="p2"><br></p>
<p class="p1">/* warnings list */</p>
<p class="p1">.warnings{ display:grid; gap:8px; margin-top:8px; }</p>
<p class="p1">.warn-item{ background: rgba(255,250,240,1); padding:10px; border-radius:8px; border:1px solid rgba(255,220,200,1); font-size:13px }</p>
<p class="p2"><br></p>
<p class="p1">/* copy/save/export row */</p>
<p class="p1">.actions-row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }</p>
<p class="p1">.action-btn{ padding:8px 12px; border-radius:8px; border:1px solid var(--border); background: linear-gradient(180deg,#ffffff,#fbfdff); cursor:pointer; font-weight:600; transition: all 220ms var(--ease) }</p>
<p class="p1">.copy-btn{ background: linear-gradient(180deg,var(--cyan), #bffeff); color:#003a3a }</p>
<p class="p1">.copy-btn.copied{ background: var(--status-green); color:#013203 }</p>
<p class="p2"><br></p>
<p class="p1">/* saved primer modal/list */</p>
<p class="p1">.saved-list{ display:grid; gap:10px; max-height:300px; overflow:auto; padding:6px }</p>
<p class="p2"><br></p>
<p class="p1">/* footer */</p>
<p class="p1">.footer{</p>
<p class="p1"><span class="Apple-converted-space">  </span>padding:16px;border-radius:12px;background:transparent;color:var(--text-secondary);font-size:13px;display:flex;align-items:center;justify-content:space-between;gap:12px</p>
<p class="p1">}</p>
<p class="p1">.footer a{ color:var(--text-secondary); text-decoration:underline; }</p>
<p class="p2"><br></p>
<p class="p1">/* tooltip */</p>
<p class="p1">.tooltip {</p>
<p class="p1"><span class="Apple-converted-space">  </span>position:relative; display:inline-block;</p>
<p class="p1">}</p>
<p class="p1">.tooltip .tip {</p>
<p class="p1"><span class="Apple-converted-space">  </span>position:absolute; left:50%; transform:translateX(-50%); bottom:calc(100% + 10px);</p>
<p class="p1"><span class="Apple-converted-space">  </span>background: var(--surface); border:1px solid var(--border); padding:8px 10px; border-radius:8px; font-size:12px; color:var(--text-secondary); width:260px; box-shadow:var(--shadow); opacity:0; pointer-events:none; transform-origin:50% 100%; transition: all 200ms var(--ease);</p>
<p class="p1">}</p>
<p class="p1">.tooltip:hover .tip, .tooltip:focus-within .tip { opacity:1; transform: translateX(-50%) translateY(-6px) }</p>
<p class="p2"><br></p>
<p class="p1">/* inputs icons / small */</p>
<p class="p1">.icon { font-size:18px; margin-right:8px; opacity:0.9; }</p>
<p class="p2"><br></p>
<p class="p1">/* responsive tweaks */</p>
<p class="p1">@media (max-width: 1280px){ .h1{ font-size:38px } }</p>
<p class="p1">@media (max-width: 600px){</p>
<p class="p1"><span class="Apple-converted-space">  </span>body{ padding:18px 12px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>.h1{ font-size:28px }</p>
<p class="p1"><span class="Apple-converted-space">  </span>.header{ padding:16px }</p>
<p class="p1"><span class="Apple-converted-space">  </span>.primary-cta{ width:100% }</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* small helper */</p>
<p class="p1">.muted{ color:var(--text-secondary); font-size:13px }</p>
<p class="p1">.center{ display:flex; align-items:center; justify-content:center; gap:8px }</p>
<p class="p1">.right{ text-align:right }</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1">&lt;div class="container" role="main"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- HEADER --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;header class="header" aria-label="DNA Primer Design Tool header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="logo" aria-hidden="true"&gt;PD&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="title"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;h1 class="h1"&gt;DNA Primer Design Tool&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;p class="h2"&gt;Design PCR primers offline · Tm, GC, hairpin, dimer, GC clamp · Copy, save, export&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="muted"&gt;Version 1.0 • Single-file&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="muted"&gt;Works offline · Accessible · Responsive&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- MAIN GRID --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="main-grid" role="region" aria-label="Main content area"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- LEFT: Input &amp; Parameters &amp; CTA --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div style="display:flex;flex-direction:column;gap:16px;"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- INPUT CARD --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;section class="card delay-1" id="inputCard" aria-labelledby="inputHeading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2 id="inputHeading" style="margin:0;font-size:20px;font-weight:700"&gt;Target DNA Sequence&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="muted" style="margin-top:6px"&gt;Paste FASTA or plain DNA sequence (A,T,G,C,N). 100–100000 bp.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="small-btn" id="clearSeqBtn" title="Clear sequence"&gt;Clear&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button class="small-btn" id="exampleBtn" title="Insert example sequence"&gt;Insert Example&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;textarea id="dnaInput" class="textarea" placeholder="Paste your DNA sequence here (ATGC...). Example:</p>
<p class="p1">&gt;Example_gene</p>
<p class="p1">ATGGCCATGGCGTTTAAACCCGGGAAATTTGGCC..." aria-label="DNA sequence input"&gt;&lt;/textarea&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="controls"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="charcount" id="charCount"&gt;Length: 0 bp&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div style="display:flex;gap:12px;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="validationMessage" class="muted" role="status" aria-live="polite"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- PARAMS CARD --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;section class="card delay-2" id="paramsCard" aria-labelledby="paramsHeading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h3 id="paramsHeading" style="margin:0 0 8px 0;font-size:18px;font-weight:700"&gt;Design Parameters&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="muted" style="margin-bottom:8px"&gt;Adjust parameters — live validation will indicate if settings are inconsistent.&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="params"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- Product size group --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="param-group" style="background:var(--mint-weak)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display:flex;justify-content:space-between;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div style="font-weight:600;color:rgba(70,85,105,1)"&gt;PCR Product Size (bp)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div class="tooltip" tabindex="0" aria-hidden="false"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span style="font-size:14px;color:var(--text-secondary)"&gt;?&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="tip"&gt;Controls the expected amplicon length. Product Size = Reverse Position - Forward Position + 1.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="param-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Minimum (bp)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-input"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;input type="number" id="minProduct" class="number-input" min="100" max="50000" value="200" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Min allowed 100&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Maximum (bp)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-input"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;input type="number" id="maxProduct" class="number-input" min="150" max="50000" value="300" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Max allowed 50000&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="productError" class="muted" style="color:var(--status-red);display:none;margin-top:8px"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- Primer length group --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="param-group" style="background:var(--cyan-weak)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="font-weight:600;color:rgba(70,85,105,1)"&gt;Primer Length (nt)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="param-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Minimum (nt)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="minPrimerLen" class="number-input" min="15" max="35" value="18" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Min 15&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Maximum (nt)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="maxPrimerLen" class="number-input" min="15" max="35" value="27" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Max 35&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="lengthError" class="muted" style="color:var(--status-red);display:none;margin-top:8px"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- Tm group --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="param-group" style="background:var(--lav-weak)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="font-weight:600;color:rgba(70,85,105,1)"&gt;Melting Temperature Tm (°C)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="param-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Optimal Tm&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="optTm" class="number-input" min="50" max="72" value="60" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Range 50–72°C&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Minimum Tm&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="minTm" class="number-input" min="45" max="72" value="54" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Range 45–72°C&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="margin-top:8px" class="param-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Maximum Tm&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="maxTm" class="number-input" min="45" max="75" value="65" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Range 45–75°C&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Max Tm Difference (°C)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="maxTmDiff" class="number-input" min="0" max="10" value="4" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;0–10°C&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="tmError" class="muted" style="color:var(--status-red);display:none;margin-top:8px"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- GC content group --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="param-group" style="background:var(--peach-weak)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="font-weight:600;color:rgba(70,85,105,1)"&gt;GC Content (%)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="param-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Minimum (%)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="minGC" class="number-input" min="20" max="80" value="40" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Range 20–80%&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Maximum (%)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="maxGC" class="number-input" min="20" max="80" value="60" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Range 20–80%&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="gcError" class="muted" style="color:var(--status-red);display:none;margin-top:8px"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- other params --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="param-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display:flex;justify-content:space-between;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div style="font-weight:600;color:rgba(70,85,105,1)"&gt;Other Settings&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div class="muted"&gt;Fine-tune checks&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="param-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Max Homopolymer Run (nt)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="maxHomopolymer" class="number-input" min="2" max="6" value="3" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;Default 3&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="param-label"&gt;Primer Pairs to Generate&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="pairsCount" class="number-input" min="1" max="10" value="3" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="muted"&gt;1–10 pairs&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display:flex;gap:12px;align-items:center;margin-top:8px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div style="display:flex;gap:8px;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="gcClampToggle" class="toggle on" role="switch" aria-checked="true" tabindex="0"&gt;&lt;div class="dot"&gt;&lt;/div&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="font-weight:600"&gt;GC Clamp Requirement&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div style="display:flex;gap:8px;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="secStructToggle" class="toggle on" role="switch" aria-checked="true" tabindex="0"&gt;&lt;div class="dot"&gt;&lt;/div&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div style="font-weight:600"&gt;Secondary Structure Checks&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="muted" style="margin-top:8px"&gt;GC clamp requires both 5' and 3' bases to be G or C when enabled.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;!-- restriction sites --&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="param-group" style="background:var(--lav-weak)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display:flex;justify-content:space-between;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div style="font-weight:600;color:rgba(70,85,105,1)"&gt;Restriction Site Checker (optional)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div class="muted"&gt;Select common sites or add custom&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label style="display:inline-flex;align-items:center;gap:6px"&gt;&lt;input type="checkbox" class="resCheck" value="GAATTC" checked /&gt; EcoRI GAATTC&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label style="display:inline-flex;align-items:center;gap:6px"&gt;&lt;input type="checkbox" class="resCheck" value="GGATCC" checked /&gt; BamHI GGATCC&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label style="display:inline-flex;align-items:center;gap:6px"&gt;&lt;input type="checkbox" class="resCheck" value="AAGCTT" checked /&gt; HindIII AAGCTT&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label style="display:inline-flex;align-items:center;gap:6px"&gt;&lt;input type="checkbox" class="resCheck" value="GCGGCCGC" /&gt; NotI GCGGCCGC&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label style="display:inline-flex;align-items:center;gap:6px"&gt;&lt;input type="checkbox" class="resCheck" value="GGTACC" /&gt; KpnI GGTACC&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label style="display:inline-flex;align-items:center;gap:6px"&gt;&lt;input type="checkbox" class="resCheck" value="CTGCAG" /&gt; PstI CTGCAG&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="margin-top:8px;display:flex;gap:8px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;input id="customRes" class="number-input" placeholder="Custom site (e.g. TCTAGA)" style="width:180px" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;button class="small-btn" id="addResBtn"&gt;Add&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- CTA --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div style="display:flex;gap:12px;align-items:center" class="cta-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="designBtn" class="primary-cta" title="Design primers"&gt;🎯 Design Primers&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="resetParams" class="small-btn"&gt;Reset to defaults&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="muted"&gt;Tip: Start with recommended defaults for best results.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- collapsible quick tips --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;section class="card delay-3" id="tipsCard" aria-labelledby="tipsHeading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="display:flex;justify-content:space-between;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h3 id="tipsHeading" style="margin:0;font-size:18px;font-weight:700"&gt;Quick Reference &amp; Best Practices&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="muted"&gt;Click to expand&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;details style="margin-top:12px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;summary style="cursor:pointer;font-weight:600"&gt;Best practices (click to expand)&lt;/summary&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div style="margin-top:10px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;ul style="margin:8px 0 0 18px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;li&gt;Primer length 18–27 nt optimal. Avoid extremes.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;li&gt;GC content 40–60% ideal for specificity and stable annealing.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;li&gt;Tm 54–65°C standard; primers in pair should differ by ≤4°C.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;li&gt;Avoid homopolymer runs ≥4; max recommended 3 consecutive identical bases.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;li&gt;Use GC clamp (G/C at both 5' and 3') to improve binding.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;li&gt;Always BLAST primers against your organism (NCBI Primer BLAST) to verify specificity.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/details&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- RIGHT: Results &amp; Saved --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;aside style="display:flex;flex-direction:column;gap:16px"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- Loading / Results Card --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;section class="card" id="resultsCard" aria-labelledby="resultsHeading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h3 id="resultsHeading" style="margin:0;font-size:18px;font-weight:700"&gt;Results&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="emptyState" style="margin-top:12px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div style="display:flex;flex-direction:column;gap:8px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div style="font-weight:600"&gt;No primers designed yet&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="muted"&gt;Paste a DNA sequence and click &lt;strong&gt;Design Primers&lt;/strong&gt;. Follow suggestions and save results.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="loadingBox" class="loading" style="margin-top:12px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="spinner" aria-hidden="true"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div id="loadingText"&gt;Designing primers — please wait...&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="resultsArea" class="results-grid" style="margin-top:12px;display:none"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div id="resultsList" class="results-list"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div id="foundMessage" class="muted"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- Save &amp; Export --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;section class="card" id="saveCard" aria-labelledby="saveHeading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h3 id="saveHeading" style="margin:0;font-size:18px;font-weight:700"&gt;Saved Primers&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="display:flex;gap:8px;margin-top:8px;align-items:center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button class="small-btn" id="viewSavedBtn"&gt;View Saved&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button class="small-btn" id="exportAllBtn"&gt;Export All&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="muted" style="margin-left:auto"&gt;Stored in browser localStorage&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="savedList" class="saved-list" style="margin-top:10px"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;!-- Extra: restriction matches &amp; gradient suggestions --&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;section class="card" aria-labelledby="extraHeading"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h3 id="extraHeading" style="margin:0;font-size:18px;font-weight:700"&gt;Additional Info&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="margin-top:8px"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div id="restrictionSummary" class="muted"&gt;Restriction site matches will appear here after design.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div id="gradientSummary" class="muted" style="margin-top:8px"&gt;Temperature gradient suggestions will appear with each primer pair.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/aside&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;!-- FOOTER --&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;footer class="footer" role="contentinfo"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div&gt;ℹ Designed for lab use. Validate primer specificity with NCBI Primer BLAST before ordering: &lt;a href="https://www.ncbi.nlm.nih.gov/tools/primer-blast/" target="_blank" rel="noopener"&gt;NCBI Primer BLAST&lt;/a&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="muted"&gt;© PrimerDesignTool • 2025 • v1.0&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/footer&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- ==========================</p>
<p class="p1"><span class="Apple-converted-space">     </span>JavaScript — All logic</p>
<p class="p1"><span class="Apple-converted-space">     </span>========================== --&gt;</p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">/* =================================================================================</p>
<p class="p1"><span class="Apple-converted-space">   </span>DNA Primer Design Tool</p>
<p class="p1"><span class="Apple-converted-space">   </span>All JS in single file. No external dependencies.</p>
<p class="p1"><span class="Apple-converted-space">   </span>Implements specified formulas and algorithms exactly as requested.</p>
<p class="p1"><span class="Apple-converted-space">   </span>================================================================================= */</p>
<p class="p2"><br></p>
<p class="p1">(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>'use strict';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Utility &amp; DOM shortcuts</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>const $ = sel =&gt; document.querySelector(sel);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const $$ = sel =&gt; Array.from(document.querySelectorAll(sel));</p>
<p class="p1"><span class="Apple-converted-space">  </span>const el = (tag, attrs = {}, ...children) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const e = document.createElement(tag);</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let k in attrs) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (k === 'class') e.className = attrs[k];</p>
<p class="p1"><span class="Apple-converted-space">      </span>else if (k === 'html') e.innerHTML = attrs[k];</p>
<p class="p1"><span class="Apple-converted-space">      </span>else e.setAttribute(k, attrs[k]);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let c of children) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (typeof c === 'string') e.appendChild(document.createTextNode(c));</p>
<p class="p1"><span class="Apple-converted-space">      </span>else if (c) e.appendChild(c);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>return e;</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Elements</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>const dnaInput = $('#dnaInput');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const charCount = $('#charCount');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const validationMessage = $('#validationMessage');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const clearSeqBtn = $('#clearSeqBtn');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const exampleBtn = $('#exampleBtn');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const minProduct = $('#minProduct');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const maxProduct = $('#maxProduct');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const minPrimerLen = $('#minPrimerLen');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const maxPrimerLen = $('#maxPrimerLen');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const optTm = $('#optTm');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const minTm = $('#minTm');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const maxTm = $('#maxTm');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const maxTmDiff = $('#maxTmDiff');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const minGC = $('#minGC');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const maxGC = $('#maxGC');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const maxHomopolymer = $('#maxHomopolymer');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const pairsCount = $('#pairsCount');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const gcClampToggle = $('#gcClampToggle');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const secStructToggle = $('#secStructToggle');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const designBtn = $('#designBtn');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const resetParams = $('#resetParams');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const loadingBox = $('#loadingBox');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const loadingText = $('#loadingText');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const resultsArea = $('#resultsArea');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const resultsList = $('#resultsList');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const emptyState = $('#emptyState');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const foundMessage = $('#foundMessage');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const savedList = $('#savedList');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const viewSavedBtn = $('#viewSavedBtn');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const exportAllBtn = $('#exportAllBtn');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const restrictionSummary = $('#restrictionSummary');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const gradientSummary = $('#gradientSummary');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const resultsCard = $('#resultsCard');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* parameter error elements */</p>
<p class="p1"><span class="Apple-converted-space">  </span>const productError = $('#productError');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const lengthError = $('#lengthError');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const tmError = $('#tmError');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const gcError = $('#gcError');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* global data */</p>
<p class="p1"><span class="Apple-converted-space">  </span>let state = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>saved: loadSavedPrimers(),</p>
<p class="p1"><span class="Apple-converted-space">    </span>restrictionSites: new Set( Array.from($$('.resCheck:checked')).map((i)=&gt; i.value) ),</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* Insert example sequence */</p>
<p class="p1"><span class="Apple-converted-space">  </span>exampleBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const ex = `&gt;Example_gene</p>
<p class="p1">ATGCGTACGATCGATCGATCGGATCTAGCTAGCTAGCGATCGATGCATGCTAGCTAGCTAGCTGATCAGCTGATCGTAGCTAGCTAGCTAACGCGATCGATCGATCGTAGCTAGCTGACTGACTGACTGACTGAC`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>dnaInput.value = ex;</p>
<p class="p1"><span class="Apple-converted-space">    </span>updateCharCount();</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>clearSeqBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>dnaInput.value = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>updateCharCount();</p>
<p class="p1"><span class="Apple-converted-space">    </span>setValidation('');</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* parameter toggles */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function toggleElement(elNode){</p>
<p class="p1"><span class="Apple-converted-space">    </span>elNode.classList.toggle('on');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const on = elNode.classList.contains('on');</p>
<p class="p1"><span class="Apple-converted-space">    </span>elNode.setAttribute('aria-checked', String(on));</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>gcClampToggle.addEventListener('click', ()=&gt; toggleElement(gcClampToggle));</p>
<p class="p1"><span class="Apple-converted-space">  </span>gcClampToggle.addEventListener('keypress', (e)=&gt; { if (e.key==='Enter') toggleElement(gcClampToggle) });</p>
<p class="p1"><span class="Apple-converted-space">  </span>secStructToggle.addEventListener('click', ()=&gt; toggleElement(secStructToggle));</p>
<p class="p1"><span class="Apple-converted-space">  </span>secStructToggle.addEventListener('keypress', (e)=&gt; { if (e.key==='Enter') toggleElement(secStructToggle) });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* add custom restriction site */</p>
<p class="p1"><span class="Apple-converted-space">  </span>$('#addResBtn').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const v = $('#customRes').value.trim().toUpperCase();</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!v) return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>state.restrictionSites.add(v);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const ch = el('label', {}, el('input',{type:'checkbox', checked:true, class:'resCheck', value:v}), ' ' + v);</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('#customRes').value = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>// append to param group</p>
<p class="p1"><span class="Apple-converted-space">    </span>$('.param-group[style*="lav-weak"]').querySelector('div').appendChild(ch);</p>
<p class="p1"><span class="Apple-converted-space">    </span>refreshRestrictionCheckboxes();</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function refreshRestrictionCheckboxes(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>state.restrictionSites = new Set(Array.from($$('.resCheck:checked')).map(i=&gt;i.value));</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>document.addEventListener('change', (e)=&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (e.target &amp;&amp; e.target.classList &amp;&amp; e.target.classList.contains('resCheck')) refreshRestrictionCheckboxes();</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* params reset */</p>
<p class="p1"><span class="Apple-converted-space">  </span>resetParams.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>minProduct.value = 200; maxProduct.value = 300;</p>
<p class="p1"><span class="Apple-converted-space">    </span>minPrimerLen.value = 18; maxPrimerLen.value = 27;</p>
<p class="p1"><span class="Apple-converted-space">    </span>optTm.value = 60; minTm.value = 54; maxTm.value = 65; maxTmDiff.value = 4;</p>
<p class="p1"><span class="Apple-converted-space">    </span>minGC.value = 40; maxGC.value = 60;</p>
<p class="p1"><span class="Apple-converted-space">    </span>maxHomopolymer.value = 3;</p>
<p class="p1"><span class="Apple-converted-space">    </span>pairsCount.value = 3;</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!gcClampToggle.classList.contains('on')) toggleElement(gcClampToggle);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!secStructToggle.classList.contains('on')) toggleElement(secStructToggle);</p>
<p class="p1"><span class="Apple-converted-space">    </span>setValidation('');</p>
<p class="p1"><span class="Apple-converted-space">    </span>productError.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>lengthError.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>tmError.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>gcError.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* live character count &amp; validation for DNA input */</p>
<p class="p1"><span class="Apple-converted-space">  </span>dnaInput.addEventListener('input', updateCharCount);</p>
<p class="p1"><span class="Apple-converted-space">  </span>function updateCharCount(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const raw = dnaInput.value || '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>const seq = extractSeq(raw);</p>
<p class="p1"><span class="Apple-converted-space">    </span>charCount.textContent = `Length: ${seq.length} bp`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// color coding: green if &gt;100 and &lt;100000</p>
<p class="p1"><span class="Apple-converted-space">    </span>const color = seq.length &gt;= 100 &amp;&amp; seq.length &lt;= 100000 ? 'var(--status-green)' : seq.length&gt;100000 ? 'var(--status-red)' : 'var(--status-yellow)';</p>
<p class="p1"><span class="Apple-converted-space">    </span>charCount.style.color = color;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// validation</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (seq.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>setValidation('');</p>
<p class="p1"><span class="Apple-converted-space">      </span>return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (seq.length &lt; 100) setValidation(`Warning - sequence too short: ${seq.length} bp (minimum 100 bp)`, 'warn');</p>
<p class="p1"><span class="Apple-converted-space">    </span>else if (seq.length &gt; 100000) setValidation(`Error - sequence too long: ${seq.length} bp (maximum 100000 bp)`, 'error');</p>
<p class="p1"><span class="Apple-converted-space">    </span>else setValidation('');</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* validation message setter */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function setValidation(msg='', type='ok'){</p>
<p class="p1"><span class="Apple-converted-space">    </span>validationMessage.textContent = msg;</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!msg) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>validationMessage.style.color = 'var(--text-secondary)';</p>
<p class="p1"><span class="Apple-converted-space">      </span>return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (type==='warn') validationMessage.style.color = 'var(--status-yellow)';</p>
<p class="p1"><span class="Apple-converted-space">    </span>else if (type==='error') validationMessage.style.color = 'var(--status-red)';</p>
<p class="p1"><span class="Apple-converted-space">    </span>else validationMessage.style.color = 'var(--status-green)';</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Sequence helpers</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Extract plain sequence: remove FASTA header lines and whitespace. Uppercase.</p>
<p class="p1"><span class="Apple-converted-space">  </span>function extractSeq(raw){</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!raw) return '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>// remove FASTA headers: lines starting with &gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>let lines = raw.split(/\r?\n/);</p>
<p class="p1"><span class="Apple-converted-space">    </span>lines = lines.filter(l =&gt; !l.startsWith('&gt;'));</p>
<p class="p1"><span class="Apple-converted-space">    </span>let seq = lines.join('').replace(/\s+/g,'').toUpperCase();</p>
<p class="p1"><span class="Apple-converted-space">    </span>// allow A,T,G,C,N only in input sequence for scanning, but candidates require A/T/G/C only</p>
<p class="p1"><span class="Apple-converted-space">    </span>return seq;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Valid base check</p>
<p class="p1"><span class="Apple-converted-space">  </span>const VALID_BASES = new Set(['A','T','G','C','N']);</p>
<p class="p1"><span class="Apple-converted-space">  </span>function checkValidBases(seq){</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let i=0;i&lt;seq.length;i++){</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!VALID_BASES.has(seq[i])) return {ok:false, pos:i+1, char:seq[i]};</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {ok:true};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Complement mapping</p>
<p class="p1"><span class="Apple-converted-space">  </span>const complementMap = {A:'T',T:'A',G:'C',C:'G',N:'N'};</p>
<p class="p1"><span class="Apple-converted-space">  </span>function complementBase(b){ return complementMap[b] || 'N'; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>function reverseComplement(s){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// assume uppercase</p>
<p class="p1"><span class="Apple-converted-space">    </span>let res = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let i = s.length -1; i&gt;=0; i--){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const b = s[i];</p>
<p class="p1"><span class="Apple-converted-space">      </span>res += complementBase(b);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>return res;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Tm &amp; GC calculations exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function calcSimpleTm(primer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// For primers shorter than 14 bp</p>
<p class="p1"><span class="Apple-converted-space">    </span>let gc = 0, at = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let c of primer){</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (c==='G' || c==='C') gc++;</p>
<p class="p1"><span class="Apple-converted-space">      </span>else if (c==='A' || c==='T') at++;</p>
<p class="p1"><span class="Apple-converted-space">      </span>else {} // if N present, handle later - but simple formula uses counts of GC and AT</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>return 4 * gc + 2 * at;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function calcNNTm(primer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// For primers 14 bp or longer: Tm = 64.9 + 41 * ((GC count - 16.4) / length)</p>
<p class="p1"><span class="Apple-converted-space">    </span>let gc = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let c of primer){</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (c==='G' || c==='C') gc++;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>const L = primer.length;</p>
<p class="p1"><span class="Apple-converted-space">    </span>return 64.9 + 41 * ((gc - 16.4) / L);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function calcTmExact(primer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// choose formula based on length exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (primer.length &lt; 14) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>return {tm: calcSimpleTm(primer), method: 'Simple'};</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">      </span>return {tm: calcNNTm(primer), method: 'NN'};</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function calcGCPercent(primer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>let gc = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let c of primer){</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (c==='G' || c==='C') gc++;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>const pct = ( (gc / primer.length) * 100 );</p>
<p class="p1"><span class="Apple-converted-space">    </span>return Math.round(pct*10)/10; // one decimal place</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Homopolymer detection exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function detectHomopolymers(primer, maxAllowed){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Scan primer character by character. Find consecutive identical bases.</p>
<p class="p1"><span class="Apple-converted-space">    </span>const issues = [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const L = primer.length;</p>
<p class="p1"><span class="Apple-converted-space">    </span>let i=0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>while (i &lt; L){</p>
<p class="p1"><span class="Apple-converted-space">      </span>let j = i+1;</p>
<p class="p1"><span class="Apple-converted-space">      </span>while (j &lt; L &amp;&amp; primer[j] === primer[i]) j++;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const runLen = j - i;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (runLen &gt;= maxAllowed){ // equals parameter =&gt; warning, exceeds =&gt; fail</p>
<p class="p1"><span class="Apple-converted-space">        </span>const posStart = i+1; // 1-based</p>
<p class="p1"><span class="Apple-converted-space">        </span>const posEnd = j; // 1-based</p>
<p class="p1"><span class="Apple-converted-space">        </span>const severity = runLen === maxAllowed ? 'warning' : 'fail';</p>
<p class="p1"><span class="Apple-converted-space">        </span>issues.push({base: primer[i], length: runLen, start: posStart, end: posEnd, severity});</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>i = j;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>return issues; // may be empty</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Hairpin formation calculation exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function hairpinPotential(primer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Take last 5 bases exactly</p>
<p class="p1"><span class="Apple-converted-space">    </span>const L = primer.length;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const last5 = primer.slice(Math.max(0, L-5), L).padStart(5, 'N'); // ensure length 5 if primer shorter - but algorithm says last 5 bases exactly as they appear, so for primers &lt;5 we still take whatever present</p>
<p class="p1"><span class="Apple-converted-space">    </span>const rc = reverseComplement(last5); // reverse complement of last 5</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Search within first 15 bases of primer for this exact reverse complement sequence</p>
<p class="p1"><span class="Apple-converted-space">    </span>const searchRegion = primer.slice(0, Math.min(15, primer.length));</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Perform approximate match: we search for exact substring match of rc with sliding window of length 5</p>
<p class="p1"><span class="Apple-converted-space">    </span>let bestMatch = {matched:0, pos:-1};</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let i=0; i &lt;= searchRegion.length - 1; i++){</p>
<p class="p1"><span class="Apple-converted-space">      </span>// we will compare rc length (5) sliding, but if near end maybe partial; still compute matched bases</p>
<p class="p1"><span class="Apple-converted-space">      </span>let matched = 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let j=0; j&lt;5; j++){</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (i+j &gt;= searchRegion.length) break;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (searchRegion[i+j] === rc[j]) matched++;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (matched &gt; bestMatch.matched) { bestMatch = {matched, pos: i+1}; }</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (matched === 5) break;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>const matchPct = Math.round((bestMatch.matched / 5) * 100);</p>
<p class="p1"><span class="Apple-converted-space">    </span>let risk = 'None';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (matchPct &gt;= 60) risk = 'High';</p>
<p class="p1"><span class="Apple-converted-space">    </span>else if (matchPct &gt;= 40) risk = 'Moderate';</p>
<p class="p1"><span class="Apple-converted-space">    </span>else if (matchPct &gt;= 20) risk = 'Low';</p>
<p class="p1"><span class="Apple-converted-space">    </span>else risk = 'None';</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {risk, matchPct, pos: bestMatch.pos}; // pos is 1-based index where match begins in primer, may be -1 if none</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Primer dimer calculation exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function primerDimerPotential(forwardPrimer, reversePrimer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// For forward primer, identify 3' end = last 8 bases of forward primer sequence</p>
<p class="p1"><span class="Apple-converted-space">    </span>const f3 = forwardPrimer.slice(Math.max(0, forwardPrimer.length - 8));</p>
<p class="p1"><span class="Apple-converted-space">    </span>// For reverse primer, calculate reverse complement of entire reverse primer sequence</p>
<p class="p1"><span class="Apple-converted-space">    </span>const rcRev = reverseComplement(reversePrimer); // rc of reverse primer</p>
<p class="p1"><span class="Apple-converted-space">    </span>// identify 5' end of this reverse complement = first 8 bases of rcRev</p>
<p class="p1"><span class="Apple-converted-space">    </span>const rc5 = rcRev.slice(0, 8);</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Compare f3 vs rc5 position by position from 1 until mismatch, count consecutive matching base pairs starting from position 1</p>
<p class="p1"><span class="Apple-converted-space">    </span>let matchCount = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let i=0; i &lt; Math.min(8, f3.length, rc5.length); i++){</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (f3[i] === rc5[i]) matchCount++;</p>
<p class="p1"><span class="Apple-converted-space">      </span>else break;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>const scorePct = Math.round((matchCount / 8) * 100);</p>
<p class="p1"><span class="Apple-converted-space">    </span>let risk = 'Low';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (matchCount &gt;= 4) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (scorePct &gt;= 75) risk = 'High';</p>
<p class="p1"><span class="Apple-converted-space">      </span>else if (scorePct &gt;= 50) risk = 'Moderate';</p>
<p class="p1"><span class="Apple-converted-space">      </span>else risk = 'Low';</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">      </span>risk = 'Low';</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {matchCount, scorePct, risk};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>GC clamp check exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function gcClampStatus(primer){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Check first and last character</p>
<p class="p1"><span class="Apple-converted-space">    </span>const first = primer[0];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const last = primer[primer.length - 1];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const isFirstGC = first === 'G' || first === 'C';</p>
<p class="p1"><span class="Apple-converted-space">    </span>const isLastGC = last === 'G' || last === 'C';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (isFirstGC &amp;&amp; isLastGC) return {status:'Present', level:'PASS'};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (isFirstGC &amp;&amp; !isLastGC) return {status:'Partial - 5 prime only', level:'WARNING'};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!isFirstGC &amp;&amp; isLastGC) return {status:'Partial - 3 prime only', level:'WARNING'};</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {status:'Absent', level:'FAIL'};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Product size calculation</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function productSize(forwardStart1Based, reverseStart1Based){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Product Size = Reverse Position - Forward Position + 1</p>
<p class="p1"><span class="Apple-converted-space">    </span>return (reverseStart1Based - forwardStart1Based + 1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Candidate generation process (steps 3 &amp; 4 exactly)</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function generatePrimers(targetSeq, params){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Validate inputs already done; generate candidates</p>
<p class="p1"><span class="Apple-converted-space">    </span>const L = targetSeq.length;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const fwdCandidates = [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const revCandidates = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const minL = params.minPrimerLen;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const maxL = params.maxPrimerLen;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Helper to test candidate meets basic criteria: contains only A/T/G/C (no N), GC within range, Tm within range</p>
<p class="p1"><span class="Apple-converted-space">    </span>function passesBasic(seq){</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let c of seq){</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!(c === 'A' || c === 'T' || c === 'G' || c === 'C')) return false; // must be only A/T/G/C</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>const gcPercent = calcGCPercent(seq);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (gcPercent &lt; params.minGC || gcPercent &gt; params.maxGC) return false;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tmObj = calcTmExact(seq);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const tm = Math.round(tmObj.tm*10)/10;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (tm &lt; params.minTm || tm &gt; params.maxTm) return false;</p>
<p class="p1"><span class="Apple-converted-space">      </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Forward primer scanning: scan left to right positions 0..L-minL</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let i=0; i &lt;= L - minL; i++){</p>
<p class="p1"><span class="Apple-converted-space">      </span>// for each start, attempt lengths minL..maxL but ensure within bounds</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let len = minL; len &lt;= maxL &amp;&amp; i + len &lt;= L; len++){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const seq = targetSeq.slice(i, i+len);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!passesBasic(seq)) continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// store candidate with attributes</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tmObj = calcTmExact(seq);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tm = Math.round(tmObj.tm*10)/10;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const gc = calcGCPercent(seq);</p>
<p class="p1"><span class="Apple-converted-space">        </span>fwdCandidates.push({</p>
<p class="p1"><span class="Apple-converted-space">          </span>start: i+1, // 1-based</p>
<p class="p1"><span class="Apple-converted-space">          </span>seq,</p>
<p class="p1"><span class="Apple-converted-space">          </span>len,</p>
<p class="p1"><span class="Apple-converted-space">          </span>tm,</p>
<p class="p1"><span class="Apple-converted-space">          </span>tmMethod: tmObj.method,</p>
<p class="p1"><span class="Apple-converted-space">          </span>gc</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Reverse primers: for reverse primers, iterate start position on original forward strand p from 0..L-minL</p>
<p class="p1"><span class="Apple-converted-space">    </span>// at each p, create primerSeq = reverseComplement(original.substr(p, len)) (this gives 5'-&gt;3' primer sequence)</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let p=0; p &lt;= L - minL; p++){</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let len = minL; len &lt;= maxL &amp;&amp; p + len &lt;= L; len++){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const origSub = targetSeq.slice(p, p+len); // original forward strand segment where reverse primer binds (5'-&gt;3' on forward)</p>
<p class="p1"><span class="Apple-converted-space">        </span>// primer sequence to present is reverse complement of origSub:</p>
<p class="p1"><span class="Apple-converted-space">        </span>const primerSeq = reverseComplement(origSub);</p>
<p class="p1"><span class="Apple-converted-space">        </span>// primer candidates must contain only A/T/G/C (reverseComplement of A/T/G/C also is A/T/G/C)</p>
<p class="p1"><span class="Apple-converted-space">        </span>// but we were told candidate must contain only A/T/G/C; origSub may contain N; reject if N present in origSub</p>
<p class="p1"><span class="Apple-converted-space">        </span>let hasInvalid=false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>for (let ch of origSub){ if (ch !== 'A' &amp;&amp; ch !== 'T' &amp;&amp; ch !== 'G' &amp;&amp; ch !== 'C') { hasInvalid = true; break; } }</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (hasInvalid) continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// check GC and Tm constraints on primerSeq</p>
<p class="p1"><span class="Apple-converted-space">        </span>const gc = calcGCPercent(primerSeq);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tmObj = calcTmExact(primerSeq);</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tm = Math.round(tmObj.tm*10)/10;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (gc &lt; params.minGC || gc &gt; params.maxGC) continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (tm &lt; params.minTm || tm &gt; params.maxTm) continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// store with start position defined as p+1 (1-based) on forward strand (leftmost base of the binding region)</p>
<p class="p1"><span class="Apple-converted-space">        </span>revCandidates.push({</p>
<p class="p1"><span class="Apple-converted-space">          </span>start: p+1,</p>
<p class="p1"><span class="Apple-converted-space">          </span>seq: primerSeq,</p>
<p class="p1"><span class="Apple-converted-space">          </span>len,</p>
<p class="p1"><span class="Apple-converted-space">          </span>tm,</p>
<p class="p1"><span class="Apple-converted-space">          </span>tmMethod: tmObj.method,</p>
<p class="p1"><span class="Apple-converted-space">          </span>gc</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>return {fwdCandidates, revCandidates};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Pairing, checking secondary structure, GC clamp, filtering (Steps 8-10)</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function evaluatePairs(fwdCandidates, revCandidates, params, targetLen){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const pairs = [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>// For efficiency, index revCandidates by start position for quick product size calc (though we'll iterate combinations)</p>
<p class="p1"><span class="Apple-converted-space">    </span>// We must create all possible combinations and then filter by product size and tm diff etc.</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let f of fwdCandidates){</p>
<p class="p1"><span class="Apple-converted-space">      </span>for (let r of revCandidates){</p>
<p class="p1"><span class="Apple-converted-space">        </span>// product size formula uses Reverse Position - Forward Position +1 (both 1-based)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const product = productSize(f.start, r.start);</p>
<p class="p1"><span class="Apple-converted-space">        </span>// product must be positive (reverse must be downstream of forward)</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (product &lt;= 0) continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// check product size within user-specified</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (product &lt; params.minProduct || product &gt; params.maxProduct) continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Compute tm difference absolute</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tmDiff = Math.abs(Math.round((f.tm - r.tm)*10)/10);</p>
<p class="p1"><span class="Apple-converted-space">        </span>// If tm difference exceeds max allowed, mark warning or fail? The specification: flag pairs exceeding limit with yellow warning. Eliminate pairs with red fail if any exists.</p>
<p class="p1"><span class="Apple-converted-space">        </span>// We'll treat exceeding maxTmDiff as WARNING (not elimination), but the algorithm steps said eliminate pairs with red fail if any exists. Later they said check if Tm difference within user-specified maximum limit -&gt; flag within limit with green pass; flag exceeding limit with yellow warning. Eliminate pairs with red fail if any exists. So we don't eliminate by tm diff unless other fails.</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Now do secondary structure checks if enabled</p>
<p class="p1"><span class="Apple-converted-space">        </span>const f_homo = detectHomopolymers(f.seq, params.maxHomopolymer); // returns issues array</p>
<p class="p1"><span class="Apple-converted-space">        </span>const r_homo = detectHomopolymers(r.seq, params.maxHomopolymer);</p>
<p class="p1"><span class="Apple-converted-space">        </span>// homopolymer severity: any 'fail' in either candidate -&gt; eliminate pair</p>
<p class="p1"><span class="Apple-converted-space">        </span>const homoFail = f_homo.some(x =&gt; x.severity==='fail') || r_homo.some(x=&gt;x.severity==='fail');</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (homoFail) continue; // eliminate pair with fail</p>
<p class="p1"><span class="Apple-converted-space">        </span>const homoWarnings = f_homo.concat(r_homo).filter(x =&gt; x.severity==='warning');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// GC clamp if enabled</p>
<p class="p1"><span class="Apple-converted-space">        </span>let gcClampResultF = null, gcClampResultR = null;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (params.gcClamp){</p>
<p class="p1"><span class="Apple-converted-space">          </span>gcClampResultF = gcClampStatus(f.seq);</p>
<p class="p1"><span class="Apple-converted-space">          </span>gcClampResultR = gcClampStatus(r.seq);</p>
<p class="p1"><span class="Apple-converted-space">          </span>// if either is FAIL, eliminate pair</p>
<p class="p1"><span class="Apple-converted-space">          </span>if (gcClampResultF.level === 'FAIL' || gcClampResultR.level === 'FAIL') continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// secondary structure: hairpin for each primer</p>
<p class="p1"><span class="Apple-converted-space">        </span>let hairpinF = null, hairpinR = null;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (params.secondaryStructure){</p>
<p class="p1"><span class="Apple-converted-space">          </span>hairpinF = hairpinPotential(f.seq);</p>
<p class="p1"><span class="Apple-converted-space">          </span>hairpinR = hairpinPotential(r.seq);</p>
<p class="p1"><span class="Apple-converted-space">          </span>// hairpin high risk should eliminate pair</p>
<p class="p1"><span class="Apple-converted-space">          </span>if (hairpinF.risk === 'High' || hairpinR.risk === 'High') continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// primer dimer check</p>
<p class="p1"><span class="Apple-converted-space">        </span>let dimer = null;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (params.secondaryStructure){</p>
<p class="p1"><span class="Apple-converted-space">          </span>dimer = primerDimerPotential(f.seq, r.seq);</p>
<p class="p1"><span class="Apple-converted-space">          </span>// if dimer risk high -&gt; eliminate pair</p>
<p class="p1"><span class="Apple-converted-space">          </span>if (dimer.risk === 'High') continue;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// At this point the pair passes elimination filters</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Determine status badges: combine parameter statuses</p>
<p class="p1"><span class="Apple-converted-space">        </span>const paramIssues = [];</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Check Tm within range for each primer already done in candidate generation; but check for being within optimal closeness too</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (tmDiff &lt;= params.maxTmDiff) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>// good</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>paramIssues.push({type:'Tm difference', level:'warning', text:`Tm difference ${tmDiff}°C exceeds max allowed ${params.maxTmDiff}°C`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// GC warnings (candidates could be on edge)</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (f.gc &lt; params.minGC || f.gc &gt; params.maxGC) paramIssues.push({type:'GC', level:'fail', text:`Forward GC ${f.gc}% outside allowed range`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (r.gc &lt; params.minGC || r.gc &gt; params.maxGC) paramIssues.push({type:'GC', level:'fail', text:`Reverse GC ${r.gc}% outside allowed range`});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// homopolymer warnings (equal to param)</p>
<p class="p1"><span class="Apple-converted-space">        </span>homoWarnings.forEach(h =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>paramIssues.push({type:'Homopolymer', level:'warning', text:`${h.length} consecutive ${h.base} bases at position ${h.start}-${h.end}`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// hairpin moderate/low</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (hairpinF &amp;&amp; (hairpinF.risk === 'Moderate' || hairpinF.risk === 'Low')){</p>
<p class="p1"><span class="Apple-converted-space">          </span>paramIssues.push({type:'Hairpin (F)', level: hairpinF.risk === 'Moderate' ? 'warning' : 'info', text: `Forward primer hairpin risk ${hairpinF.risk} - ${hairpinF.matchPct}% complementarity at position ${hairpinF.pos}`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (hairpinR &amp;&amp; (hairpinR.risk === 'Moderate' || hairpinR.risk === 'Low')){</p>
<p class="p1"><span class="Apple-converted-space">          </span>paramIssues.push({type:'Hairpin (R)', level: hairpinR.risk === 'Moderate' ? 'warning' : 'info', text: `Reverse primer hairpin risk ${hairpinR.risk} - ${hairpinR.matchPct}% complementarity at position ${hairpinR.pos}`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// primer dimer moderate/low</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (dimer &amp;&amp; (dimer.risk === 'Moderate' || dimer.risk === 'Low')){</p>
<p class="p1"><span class="Apple-converted-space">          </span>paramIssues.push({type:'Dimer', level: dimer.risk === 'Moderate' ? 'warning' : 'info', text: `Primer dimer potential ${dimer.risk} - ${dimer.scorePct}% similarity at 3' ends`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// GC clamp partial warnings</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (gcClampResultF &amp;&amp; gcClampResultF.level === 'WARNING') paramIssues.push({type:'GC Clamp (F)', level:'warning', text:`Forward: ${gcClampResultF.status}`});</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (gcClampResultR &amp;&amp; gcClampResultR.level === 'WARNING') paramIssues.push({type:'GC Clamp (R)', level:'warning', text:`Reverse: ${gcClampResultR.status}`});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// A final overall status</p>
<p class="p1"><span class="Apple-converted-space">        </span>let overall = 'PASS';</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (paramIssues.some(x=&gt; x.level === 'fail')) overall = 'FAIL';</p>
<p class="p1"><span class="Apple-converted-space">        </span>else if (paramIssues.some(x=&gt; x.level === 'warning')) overall = 'WARNING';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Score and bonus ranking</p>
<p class="p1"><span class="Apple-converted-space">        </span>let score = 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (overall === 'PASS') score += 100;</p>
<p class="p1"><span class="Apple-converted-space">        </span>else if (overall === 'WARNING') score += 60;</p>
<p class="p1"><span class="Apple-converted-space">        </span>else score += 10;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// bonus for closeness to optTm and mid-range GC</p>
<p class="p1"><span class="Apple-converted-space">        </span>const avgTm = (f.tm + r.tm) / 2;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tmDiffToOpt = Math.abs(avgTm - params.optTm);</p>
<p class="p1"><span class="Apple-converted-space">        </span>score -= Math.round(tmDiffToOpt * 2); // penalize deviation</p>
<p class="p1"><span class="Apple-converted-space">        </span>const avgGC = (f.gc + r.gc)/2;</p>
<p class="p1"><span class="Apple-converted-space">        </span>score -= Math.round(Math.abs(avgGC - ((params.minGC + params.maxGC)/2)) * 0.5);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>pairs.push({</p>
<p class="p1"><span class="Apple-converted-space">          </span>forward: f,</p>
<p class="p1"><span class="Apple-converted-space">          </span>reverse: r,</p>
<p class="p1"><span class="Apple-converted-space">          </span>product,</p>
<p class="p1"><span class="Apple-converted-space">          </span>tmDiff,</p>
<p class="p1"><span class="Apple-converted-space">          </span>paramIssues,</p>
<p class="p1"><span class="Apple-converted-space">          </span>overall,</p>
<p class="p1"><span class="Apple-converted-space">          </span>score,</p>
<p class="p1"><span class="Apple-converted-space">          </span>dimer,</p>
<p class="p1"><span class="Apple-converted-space">          </span>hairpinF,</p>
<p class="p1"><span class="Apple-converted-space">          </span>hairpinR,</p>
<p class="p1"><span class="Apple-converted-space">          </span>gcClampResultF,</p>
<p class="p1"><span class="Apple-converted-space">          </span>gcClampResultR,</p>
<p class="p1"><span class="Apple-converted-space">          </span>homoWarnings</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Now sort by score descending</p>
<p class="p1"><span class="Apple-converted-space">    </span>pairs.sort((a,b)=&gt; b.score - a.score);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return pairs;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Ranking &amp; selecting top N pairs (Step 11)</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function selectTopPairs(pairs, N){</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (pairs.length === 0) return [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>return pairs.slice(0, N);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Prepare display output for each selected primer pair (Step 12)</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function renderResults(pairs, params, targetSeq){</p>
<p class="p1"><span class="Apple-converted-space">    </span>resultsList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!pairs || pairs.length === 0){</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultsArea.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">      </span>resultsList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">      </span>foundMessage.textContent = 'No suitable primer pairs found with current parameters.';</p>
<p class="p1"><span class="Apple-converted-space">      </span>return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>emptyState.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>resultsArea.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">    </span>foundMessage.textContent = `Found ${pairs.length} primer pair(s). Showing top ${pairs.length &gt; params.pairsCount ? params.pairsCount : pairs.length}.`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// For each pair build card</p>
<p class="p1"><span class="Apple-converted-space">    </span>pairs.forEach((p, idx) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const card = el('div', {class:'pair-card'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>// add show animation staggered</p>
<p class="p1"><span class="Apple-converted-space">      </span>setTimeout(()=&gt; card.classList.add('show'), idx*120);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const header = el('div', {style:'display:flex;justify-content:space-between;align-items:center'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>header.appendChild(el('div', {style:'font-weight:700'}, `Primer Pair ${idx+1}`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const overallBadge = el('div', {class:`badge ${p.overall==='PASS' ? 'pass' : p.overall==='WARNING' ? 'warn' : 'fail'}`}, `${p.overall==='PASS' ? '✔ PASS' : p.overall==='WARNING' ? '⚠ WARNING' : '✖ FAIL'}`);</p>
<p class="p1"><span class="Apple-converted-space">      </span>header.appendChild(overallBadge);</p>
<p class="p1"><span class="Apple-converted-space">      </span>card.appendChild(header);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// forward and reverse boxes</p>
<p class="p1"><span class="Apple-converted-space">      </span>const primerRow = el('div', {class:'primer-row'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>const fbox = el('div', {class:'primer-box fwd'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rbox = el('div', {class:'primer-box rev'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>fbox.appendChild(el('div', {style:'font-weight:600'}, "Forward Primer (5' → 3')"));</p>
<p class="p1"><span class="Apple-converted-space">      </span>fbox.appendChild(el('div', {class:'seq'}, `5' → ${p.forward.seq} ← 3'`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>fbox.appendChild(el('div', {class:'meta-grid'},</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `Length: ${p.forward.len} bp`),</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `Tm: ${p.forward.tm} °C (${p.forward.tmMethod})`),</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `GC: ${p.forward.gc} %`),</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `Start Position: ${p.forward.start} bp`)</p>
<p class="p1"><span class="Apple-converted-space">      </span>));</p>
<p class="p1"><span class="Apple-converted-space">      </span>// status small</p>
<p class="p1"><span class="Apple-converted-space">      </span>const fstatus = p.gcClampResultF ? p.gcClampResultF.status : 'Not checked';</p>
<p class="p1"><span class="Apple-converted-space">      </span>fbox.appendChild(el('div', {class:'muted'}, `GC Clamp: ${fstatus}`));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>rbox.appendChild(el('div', {style:'font-weight:600'}, "Reverse Primer (5' → 3')"));</p>
<p class="p1"><span class="Apple-converted-space">      </span>rbox.appendChild(el('div', {class:'seq'}, `5' → ${p.reverse.seq} ← 3'`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>rbox.appendChild(el('div', {class:'meta-grid'},</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `Length: ${p.reverse.len} bp`),</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `Tm: ${p.reverse.tm} °C (${p.reverse.tmMethod})`),</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `GC: ${p.reverse.gc} %`),</p>
<p class="p1"><span class="Apple-converted-space">        </span>el('div', {}, `Start Position: ${p.reverse.start} bp`)</p>
<p class="p1"><span class="Apple-converted-space">      </span>));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rstatus = p.gcClampResultR ? p.gcClampResultR.status : 'Not checked';</p>
<p class="p1"><span class="Apple-converted-space">      </span>rbox.appendChild(el('div', {class:'muted'}, `GC Clamp: ${rstatus}`));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>primerRow.appendChild(fbox);</p>
<p class="p1"><span class="Apple-converted-space">      </span>primerRow.appendChild(rbox);</p>
<p class="p1"><span class="Apple-converted-space">      </span>card.appendChild(primerRow);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// combined info</p>
<p class="p1"><span class="Apple-converted-space">      </span>const combo = el('div', {style:'display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:8px;flex-wrap:wrap'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>combo.appendChild(el('div', {}, `Expected PCR product size: ${p.product} bp`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>combo.appendChild(el('div', {}, `Tm Difference: ${p.tmDiff} °C`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>combo.appendChild(el('div', {}, `Compatibility: ${p.overall === 'PASS' ? 'Compatible' : p.overall === 'WARNING' ? 'Possibly compatible' : 'Incompatible'}`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>card.appendChild(combo);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Warnings section listing paramIssues</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (p.paramIssues &amp;&amp; p.paramIssues.length &gt; 0){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const warns = el('div', {class:'warnings'});</p>
<p class="p1"><span class="Apple-converted-space">        </span>p.paramIssues.forEach(pi =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const color = pi.level === 'fail' ? 'var(--status-red)' : pi.level === 'warning' ? 'var(--status-yellow)' : 'var(--text-secondary)';</p>
<p class="p1"><span class="Apple-converted-space">          </span>const icon = pi.level === 'fail' ? '✖' : pi.level === 'warning' ? '⚠' : 'ℹ';</p>
<p class="p1"><span class="Apple-converted-space">          </span>warns.appendChild(el('div', {class:'warn-item'}, `${icon} ${pi.type} — ${pi.text}`));</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>card.appendChild(warns);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// restriction sites check in primers</p>
<p class="p1"><span class="Apple-converted-space">      </span>const restrictionFinds = checkRestrictionSitesInPair(p, state.restrictionSites);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (restrictionFinds.length &gt; 0){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const rdiv = el('div', {style:'margin-top:8px'}, el('div',{style:'font-weight:600'}, 'Restriction Site Matches'));</p>
<p class="p1"><span class="Apple-converted-space">        </span>restrictionFinds.forEach(rf =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>rdiv.appendChild(el('div',{class:'muted'}, `${rf.site} in ${rf.which} at position ${rf.pos}`));</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>card.appendChild(rdiv);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// gradient suggestion</p>
<p class="p1"><span class="Apple-converted-space">      </span>const gradient = suggestTemperatureGradient(p);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const gradDiv = el('div', {style:'margin-top:8px'}, el('div',{style:'font-weight:600'}, 'Suggested Gradient PCR Temperatures'));</p>
<p class="p1"><span class="Apple-converted-space">      </span>gradDiv.appendChild(el('div',{class:'muted'}, gradient.join(', ')));</p>
<p class="p1"><span class="Apple-converted-space">      </span>card.appendChild(gradDiv);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// actions: copy, copy sequences only, save, export</p>
<p class="p1"><span class="Apple-converted-space">      </span>const actions = el('div',{class:'actions-row', style:'margin-top:8px'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>const copyBtn = el('button',{class:'action-btn copy-btn'}, 'Copy Sequences');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const copySeqOnlyBtn = el('button',{class:'action-btn'}, 'Copy Just Sequences');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const saveBtn = el('button',{class:'action-btn'}, 'Save Pair');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const exportBtn = el('button',{class:'action-btn'}, 'Export CSV');</p>
<p class="p1"><span class="Apple-converted-space">      </span>actions.appendChild(copyBtn);</p>
<p class="p1"><span class="Apple-converted-space">      </span>actions.appendChild(copySeqOnlyBtn);</p>
<p class="p1"><span class="Apple-converted-space">      </span>actions.appendChild(saveBtn);</p>
<p class="p1"><span class="Apple-converted-space">      </span>actions.appendChild(exportBtn);</p>
<p class="p1"><span class="Apple-converted-space">      </span>card.appendChild(actions);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// copy functionality</p>
<p class="p1"><span class="Apple-converted-space">      </span>copyBtn.addEventListener('click', async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const txt = formatPrimerPairForCopy(p, idx+1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>try{</p>
<p class="p1"><span class="Apple-converted-space">          </span>await navigator.clipboard.writeText(txt);</p>
<p class="p1"><span class="Apple-converted-space">          </span>copyBtn.classList.add('copied'); copyBtn.textContent = 'Copied ✓';</p>
<p class="p1"><span class="Apple-converted-space">          </span>setTimeout(()=&gt; { copyBtn.classList.remove('copied'); copyBtn.textContent = 'Copy Sequences'; }, 2000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}catch(e){</p>
<p class="p1"><span class="Apple-converted-space">          </span>alert('Copy failed — your browser may restrict clipboard access.');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>copySeqOnlyBtn.addEventListener('click', async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const txt = `${p.forward.seq}\n${p.reverse.seq}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>try{</p>
<p class="p1"><span class="Apple-converted-space">          </span>await navigator.clipboard.writeText(txt);</p>
<p class="p1"><span class="Apple-converted-space">          </span>copySeqOnlyBtn.textContent = 'Copied ✓';</p>
<p class="p1"><span class="Apple-converted-space">          </span>setTimeout(()=&gt; copySeqOnlyBtn.textContent = 'Copy Just Sequences', 2000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}catch(e){ alert('Copy failed — your browser may restrict clipboard access.'); }</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>saveBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const name = prompt('Enter primer name (Prefix will be used for forward/reverse):', `Primer_${idx+1}`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (name === null) return;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const saved = {</p>
<p class="p1"><span class="Apple-converted-space">          </span>id: 'p_' + Date.now(),</p>
<p class="p1"><span class="Apple-converted-space">          </span>name,</p>
<p class="p1"><span class="Apple-converted-space">          </span>timestamp: new Date().toISOString(),</p>
<p class="p1"><span class="Apple-converted-space">          </span>params,</p>
<p class="p1"><span class="Apple-converted-space">          </span>pair: p</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>savePrimer(saved);</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert('Saved primer pair.');</p>
<p class="p1"><span class="Apple-converted-space">        </span>renderSavedList();</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>exportBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const csv = exportPairAsCSV(p, idx+1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>downloadTextFile(csv, `primer_pair_${idx+1}.csv`);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>resultsList.appendChild(card);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* Format copy text */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function formatPrimerPairForCopy(p, pairIndex){</p>
<p class="p1"><span class="Apple-converted-space">    </span>return `Primer Pair ${pairIndex}</p>
<p class="p1">Forward Primer 5'→3': ${p.forward.seq}</p>
<p class="p1">Length: ${p.forward.len} bp; Tm: ${p.forward.tm} °C (${p.forward.tmMethod}); GC: ${p.forward.gc} %</p>
<p class="p1">Reverse Primer 5'→3': ${p.reverse.seq}</p>
<p class="p1">Length: ${p.reverse.len} bp; Tm: ${p.reverse.tm} °C (${p.reverse.tmMethod}); GC: ${p.reverse.gc} %</p>
<p class="p1">Expected PCR Product Size: ${p.product} bp</p>
<p class="p1">Tm Difference: ${p.tmDiff} °C</p>
<p class="p1">Overall Status: ${p.overall}</p>
<p class="p1">`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* export as CSV */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function exportPairAsCSV(p, idx){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const headers = ['PairID','ForwardSeq','ForwardLen','ForwardTm','ForwardTmMethod','ForwardGC','ForwardStart','ReverseSeq','ReverseLen','ReverseTm','ReverseTmMethod','ReverseGC','ReverseStart','ProductSize','TmDifference','OverallStatus'];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const values = [</p>
<p class="p1"><span class="Apple-converted-space">      </span>idx,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.forward.seq,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.forward.len,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.forward.tm,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.forward.tmMethod,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.forward.gc,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.forward.start,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.reverse.seq,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.reverse.len,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.reverse.tm,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.reverse.tmMethod,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.reverse.gc,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.reverse.start,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.product,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.tmDiff,</p>
<p class="p1"><span class="Apple-converted-space">      </span>p.overall</p>
<p class="p1"><span class="Apple-converted-space">    </span>];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const csv = headers.join(',') + '\n' + values.map(v =&gt; `"${String(v).replace(/"/g,'""')}"`).join(',');</p>
<p class="p1"><span class="Apple-converted-space">    </span>return csv;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function downloadTextFile(text, filename){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const blob = new Blob([text], {type: 'text/plain'});</p>
<p class="p1"><span class="Apple-converted-space">    </span>const url = URL.createObjectURL(blob);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const a = document.createElement('a');</p>
<p class="p1"><span class="Apple-converted-space">    </span>a.href = url; a.download = filename;</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.body.appendChild(a); a.click();</p>
<p class="p1"><span class="Apple-converted-space">    </span>a.remove(); URL.revokeObjectURL(url);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Restriction site checking</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function checkRestrictionSitesInPair(pair, sitesSet){</p>
<p class="p1"><span class="Apple-converted-space">    </span>const out = [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const sites = Array.from(sitesSet);</p>
<p class="p1"><span class="Apple-converted-space">    </span>sites.forEach(site =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>// forward seq</p>
<p class="p1"><span class="Apple-converted-space">      </span>const idxF = pair.forward.seq.indexOf(site);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (idxF !== -1) out.push({which:'Forward', site, pos: idxF+1});</p>
<p class="p1"><span class="Apple-converted-space">      </span>const idxR = pair.reverse.seq.indexOf(site);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (idxR !== -1) out.push({which:'Reverse', site, pos: idxR+1});</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>return out;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Temperature gradient suggestion</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function suggestTemperatureGradient(pair){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Suggest gradient range as +/- 2-3 degrees around calculated optimal temperature.</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Use average Tm as center.</p>
<p class="p1"><span class="Apple-converted-space">    </span>const avgTm = Math.round(((pair.forward.tm + pair.reverse.tm)/2)*10)/10;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// make 5 conditions spanning avgTm-4 to avgTm+4 in steps of 2</p>
<p class="p1"><span class="Apple-converted-space">    </span>const start = Math.round((avgTm - 4));</p>
<p class="p1"><span class="Apple-converted-space">    </span>const temps = [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>for (let t = start; t &lt;= start + 8; t += 2) temps.push(`${t}°C`);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return temps;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Saving / localStorage</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function loadSavedPrimers(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>try{</p>
<p class="p1"><span class="Apple-converted-space">      </span>const raw = localStorage.getItem('primer_design_saved_v1');</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!raw) return [];</p>
<p class="p1"><span class="Apple-converted-space">      </span>return JSON.parse(raw);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}catch(e){ return []; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>function savePrimer(obj){</p>
<p class="p1"><span class="Apple-converted-space">    </span>state.saved.push(obj);</p>
<p class="p1"><span class="Apple-converted-space">    </span>localStorage.setItem('primer_design_saved_v1', JSON.stringify(state.saved));</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>function deleteSaved(id){</p>
<p class="p1"><span class="Apple-converted-space">    </span>state.saved = state.saved.filter(s =&gt; s.id !== id);</p>
<p class="p1"><span class="Apple-converted-space">    </span>localStorage.setItem('primer_design_saved_v1', JSON.stringify(state.saved));</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderSavedList();</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>function renderSavedList(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>savedList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!state.saved || state.saved.length === 0) { savedList.appendChild(el('div', {class:'muted'}, 'No saved primers')); return; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>state.saved.slice().reverse().forEach(s =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const box = el('div', {style:'padding:10px;border:1px solid var(--border);border-radius:10px;display:flex;gap:8px;align-items:center;justify-content:space-between;background:#fff'});</p>
<p class="p1"><span class="Apple-converted-space">      </span>const left = el('div', {}, el('div',{style:'font-weight:700'}, s.name), el('div',{class:'muted'}, new Date(s.timestamp).toLocaleString()));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const actions = el('div', {style:'display:flex;gap:6px'}, el('button',{class:'small-btn'}, 'View'), el('button',{class:'small-btn'}, 'Delete'));</p>
<p class="p1"><span class="Apple-converted-space">      </span>actions.children[0].addEventListener('click', ()=&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>// show modal/details</p>
<p class="p1"><span class="Apple-converted-space">        </span>const txt = `Name: ${s.name}\nSaved: ${new Date(s.timestamp).toLocaleString()}\n\nForward: ${s.pair.forward.seq}\nReverse: ${s.pair.reverse.seq}\nProduct Size: ${s.pair.product}\nOverall: ${s.pair.overall}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>alert(txt);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>actions.children[1].addEventListener('click', ()=&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (confirm('Delete this saved primer?')) deleteSaved(s.id);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>box.appendChild(left); box.appendChild(actions);</p>
<p class="p1"><span class="Apple-converted-space">      </span>savedList.appendChild(box);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>viewSavedBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderSavedList();</p>
<p class="p1"><span class="Apple-converted-space">    </span>// scroll to savedList</p>
<p class="p1"><span class="Apple-converted-space">    </span>savedList.scrollIntoView({behavior:'smooth', block:'center'});</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>exportAllBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!state.saved || state.saved.length === 0) { alert('No saved primers to export.'); return; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>const csvRows = [];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const headers = ['ID','Name','Timestamp','PairIndex','ForwardSeq','ForwardLen','ForwardTm','ForwardGC','ForwardStart','ReverseSeq','ReverseLen','ReverseTm','ReverseGC','ReverseStart','ProductSize','TmDiff','Overall'];</p>
<p class="p1"><span class="Apple-converted-space">    </span>csvRows.push(headers.join(','));</p>
<p class="p1"><span class="Apple-converted-space">    </span>state.saved.forEach((s, idx) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const p = s.pair;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const row = [s.id, s.name, s.timestamp, idx+1, p.forward.seq, p.forward.len, p.forward.tm, p.forward.gc, p.forward.start, p.reverse.seq, p.reverse.len, p.reverse.tm, p.reverse.gc, p.reverse.start, p.product, p.tmDiff, p.overall];</p>
<p class="p1"><span class="Apple-converted-space">      </span>csvRows.push(row.map(v =&gt; `"${String(v).replace(/"/g,'""')}"`).join(','));</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>downloadTextFile(csvRows.join('\n'), 'saved_primers.csv');</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>Design button main flow (Steps 1-12)</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>designBtn.addEventListener('click', async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Prevent multiple clicks</p>
<p class="p1"><span class="Apple-converted-space">    </span>designBtn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">    </span>designBtn.classList.add('clicked');</p>
<p class="p1"><span class="Apple-converted-space">    </span>setTimeout(()=&gt; { designBtn.disabled = false; designBtn.classList.remove('clicked'); }, 800);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Step 1: Validate input sequence</p>
<p class="p1"><span class="Apple-converted-space">    </span>const raw = dnaInput.value || '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>const seq = extractSeq(raw);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!seq || seq.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>showError('Error - no sequence found. Paste a DNA sequence first (FASTA or plain).');</p>
<p class="p1"><span class="Apple-converted-space">      </span>return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (seq.length &lt; 100) { showError(`Error - Sequence too short. Minimum 100 base pairs required. Current length: ${seq.length} bp.`); return; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (seq.length &gt; 100000) { showError(`Error - Sequence too long. Maximum 100000 base pairs allowed. Current length: ${seq.length} bp.`); return; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>const baseCheck = checkValidBases(seq);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!baseCheck.ok) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>showError(`Error - Invalid DNA base found at position ${baseCheck.pos}. Found character '${baseCheck.char}'. Only A, T, G, C, N allowed.`); return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Step 2: Validate Parameters</p>
<p class="p1"><span class="Apple-converted-space">    </span>const params = readParams();</p>
<p class="p1"><span class="Apple-converted-space">    </span>const paramValid = validateParams(params);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!paramValid.ok) { showError(paramValid.msg); return; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Show loading</p>
<p class="p1"><span class="Apple-converted-space">    </span>emptyState.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>resultsArea.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>loadingBox.style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">    </span>loadingText.textContent = 'Designing primers — please wait...';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Do heavy calculation in a small setTimeout to allow UI update (no web workers here)</p>
<p class="p1"><span class="Apple-converted-space">    </span>setTimeout(()=&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Step 3 &amp; 4: generate candidates</p>
<p class="p1"><span class="Apple-converted-space">      </span>const {fwdCandidates, revCandidates} = generatePrimers(seq, params);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Step 5 &amp; 6 already computed tm and gc during generation</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Step 7: homopolymer checks applied later during pairing</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Step 8-10: pairing and checks</p>
<p class="p1"><span class="Apple-converted-space">      </span>const allPairs = evaluatePairs(fwdCandidates, revCandidates, params, seq.length);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Step 11: ranking and select top N</p>
<p class="p1"><span class="Apple-converted-space">      </span>const top = selectTopPairs(allPairs, params.pairsCount);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Step 12: prepare output and show results</p>
<p class="p1"><span class="Apple-converted-space">      </span>loadingBox.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Render results</p>
<p class="p1"><span class="Apple-converted-space">      </span>renderResults(top, params, seq);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// show restriction summary &amp; gradient</p>
<p class="p1"><span class="Apple-converted-space">      </span>const allResMatches = [];</p>
<p class="p1"><span class="Apple-converted-space">      </span>top.forEach(p =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const res = checkRestrictionSitesInPair(p, state.restrictionSites);</p>
<p class="p1"><span class="Apple-converted-space">        </span>res.forEach(rf =&gt; allResMatches.push(`${rf.which}: ${rf.site} at ${rf.pos}`));</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>restrictionSummary.textContent = allResMatches.length ? 'Restriction sites found: ' + allResMatches.join('; ') : 'No selected restriction sites found in top primer pairs.';</p>
<p class="p1"><span class="Apple-converted-space">      </span>// gradient summary from first pair</p>
<p class="p1"><span class="Apple-converted-space">      </span>gradientSummary.textContent = top.length ? 'Example gradient: ' + suggestTemperatureGradient(top[0]).join(', ') : '';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// If found fewer than requested, inform user</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (top.length &lt; params.pairsCount) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>foundMessage.textContent = `Found ${top.length} suitable primer pairs instead of requested ${params.pairsCount} pairs due to strict parameters.`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>designBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}, 60);</p>
<p class="p1"><span class="Apple-converted-space">  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function showError(msg){</p>
<p class="p1"><span class="Apple-converted-space">    </span>loadingBox.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>resultsArea.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">    </span>resultsList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>foundMessage.textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">    </span>emptyState.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>// display as bright red message at top of results card</p>
<p class="p1"><span class="Apple-converted-space">    </span>resultsList.innerHTML = `&lt;div style="padding:12px;border-radius:10px;background:rgba(255,240,240,1);border:1px solid rgba(255,200,200,1)"&gt;${msg}&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>designBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function readParams(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {</p>
<p class="p1"><span class="Apple-converted-space">      </span>minProduct: Number(minProduct.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>maxProduct: Number(maxProduct.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>minPrimerLen: Number(minPrimerLen.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>maxPrimerLen: Number(maxPrimerLen.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>optTm: Number(optTm.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>minTm: Number(minTm.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>maxTm: Number(maxTm.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>maxTmDiff: Number(maxTmDiff.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>minGC: Number(minGC.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>maxGC: Number(maxGC.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>maxHomopolymer: Number(maxHomopolymer.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>pairsCount: Number(pairsCount.value),</p>
<p class="p1"><span class="Apple-converted-space">      </span>gcClamp: gcClampToggle.classList.contains('on'),</p>
<p class="p1"><span class="Apple-converted-space">      </span>secondaryStructure: secStructToggle.classList.contains('on'),</p>
<p class="p1"><span class="Apple-converted-space">      </span>restrictionSites: Array.from(state.restrictionSites)</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function validateParams(p){</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Validate ranges and logical consistency with messages exactly as specified</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.minProduct &lt; 100) return {ok:false, msg: `Error - Minimum PCR product size must be at least 100 bp.`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.maxProduct &gt; 50000) return {ok:false, msg: `Error - Maximum PCR product size must be ≤ 50000 bp.`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.maxProduct &lt;= p.minProduct) return {ok:false, msg: `Error - Maximum PCR product size must be greater than minimum.`};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.minPrimerLen &lt; 15 || p.maxPrimerLen &lt; 15) return {ok:false, msg: `Error - Primer length minimum allowed is 15 nt.`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.maxPrimerLen &gt; 35 || p.minPrimerLen &gt; 35) return {ok:false, msg: `Error - Primer length maximum allowed is 35 nt.`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.maxPrimerLen &lt; p.minPrimerLen) return {ok:false, msg: `Error - Maximum primer length must be &gt;= minimum primer length.`};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.minTm &gt;= p.optTm) return {ok:false, msg: `Error - Minimum Tm (${p.minTm}°C) must be less than Optimal Tm (${p.optTm}°C).`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.optTm &gt;= p.maxTm) return {ok:false, msg: `Error - Optimal Tm (${p.optTm}°C) must be less than Maximum Tm (${p.maxTm}°C).`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.minTm &lt; 45 || p.maxTm &gt; 75) return {ok:false, msg: `Error - Tm values out of allowed range.`};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.minGC &lt; 20 || p.maxGC &gt; 80) return {ok:false, msg: 'Error - GC content must be between 20 and 80 percent.'};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.minGC &gt; p.maxGC) return {ok:false, msg: `Error - Maximum GC content must be greater than or equal to Minimum GC content.`};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.maxTmDiff &lt; 0) return {ok:false, msg: `Error - Maximum Tm difference must be &gt;= 0.`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.maxHomopolymer &lt; 2) return {ok:false, msg: `Error - Homopolymer run minimum is 2.`};</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (p.pairsCount &lt; 1 || p.pairsCount &gt; 10) return {ok:false, msg: `Error - Number of primer pairs must be between 1 and 10.`};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>return {ok:true};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>/* -------------------------</p>
<p class="p1"><span class="Apple-converted-space">     </span>On load: initial UI setup</p>
<p class="p1"><span class="Apple-converted-space">     </span>------------------------- */</p>
<p class="p1"><span class="Apple-converted-space">  </span>function init(){</p>
<p class="p1"><span class="Apple-converted-space">    </span>updateCharCount();</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderSavedList();</p>
<p class="p1"><span class="Apple-converted-space">    </span>// animate header and cards with stagger</p>
<p class="p1"><span class="Apple-converted-space">    </span>setTimeout(()=&gt; $('.header').style.opacity = 1, 10);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// accessibility: allow keyboard toggles</p>
<p class="p1"><span class="Apple-converted-space">    </span>$$('.toggle').forEach(t =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>t.addEventListener('keydown', (e)=&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleElement(t); }</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// allow keyboard focus on results cards copy</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.addEventListener('keydown', (e)=&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (e.key === 'F2') { designBtn.click(); }</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// small: refresh restriction checkboxes initial</p>
<p class="p1"><span class="Apple-converted-space">    </span>refreshRestrictionCheckboxes();</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>init();</p>
<p class="p2"><br></p>
<p class="p1">})();</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
